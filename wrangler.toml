name = "voice-ai-dashboard-api"
main = "workers/index.ts"
compatibility_date = "2024-10-16"
account_id = "208f128290b10d58d5de18909148acc0"

# Custom domain (commented out for local dev)
# routes = [
#   { pattern = "api.voice-config.channelautomation.com", custom_domain = true }
# ]

# D1 Database binding
[[d1_databases]]
binding = "DB"
database_name = "voice-ai-dashboard"
database_id = "68edb24b-9705-4b29-b5c5-d702dc78a6fb"
preview_database_id = "68edb24b-9705-4b29-b5c5-d702dc78a6fb"
migrations_dir = "workers/migrations"

# KV namespace for caching
[[kv_namespaces]]
binding = "CACHE"
id = "1957b2d9d695460ebba474ba4be11def"
preview_id = "1957b2d9d695460ebba474ba4be11def"

# R2 bucket for call recordings
[[r2_buckets]]
binding = "RECORDINGS"
bucket_name = "voice-ai-recordings"
preview_bucket_name = "voice-ai-recordings"

# Environment variables
[vars]
JWT_SECRET = "change-this-to-a-secure-random-string-in-production"

# Salesforce OAuth Credentials
# TODO: Replace with your Salesforce Connected App credentials
SALESFORCE_CLIENT_ID = "your-salesforce-consumer-key-here"
SALESFORCE_CLIENT_SECRET = "your-salesforce-consumer-secret-here"

# HubSpot OAuth Credentials
# Configured via wrangler secrets:
# wrangler secret put HUBSPOT_CLIENT_ID
# wrangler secret put HUBSPOT_CLIENT_SECRET

# Microsoft Dynamics 365 OAuth Credentials
# Configured via wrangler secrets:
# wrangler secret put DYNAMICS_CLIENT_ID
# wrangler secret put DYNAMICS_CLIENT_SECRET
# wrangler secret put DYNAMICS_TENANT_ID

# SendGrid Email Service
# Configured via wrangler secrets:
# wrangler secret put SENDGRID_API_KEY

# For production, use:
# wrangler secret put JWT_SECRET
# wrangler secret put SALESFORCE_CLIENT_ID
# wrangler secret put SALESFORCE_CLIENT_SECRET
# wrangler secret put HUBSPOT_CLIENT_ID
# wrangler secret put HUBSPOT_CLIENT_SECRET
# wrangler secret put DYNAMICS_CLIENT_ID
# wrangler secret put DYNAMICS_CLIENT_SECRET
# wrangler secret put DYNAMICS_TENANT_ID
# wrangler secret put SENDGRID_API_KEY

# Cron trigger for cleanup jobs
[triggers]
crons = ["0 */6 * * *"]  # Run every 6 hours

# Observability - Logs and Tracing
# View logs and traces in Workers Observability dashboard
# Docs: https://developers.cloudflare.com/workers/observability/traces/
[observability]
enabled = false
head_sampling_rate = 1

[observability.logs]
enabled = true
head_sampling_rate = 1
persist = true
invocation_logs = true

[observability.traces]
enabled = true
head_sampling_rate = 1
persist = true

